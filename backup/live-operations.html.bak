<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weld Insight - Live Operations</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/live-operations.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
</head>
<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="nav-left">
            <a href="main.html" class="logo" style="display: flex; align-items: center; gap: var(--spacing-sm); color: inherit; text-decoration: none;">
                <img src="assets/icons/rbw_logo.png" alt="RB-WARE" class="logo-image">
                <span>Weld Insight</span>
            </a>
        </div>
        <div class="nav-center">
            <div class="site-selector" id="siteSelectorDropdown">
                <span class="site-selector-text" id="selectedSite" data-i18n="nav.site.all">Ï°∞ÏÑ†ÏÜå Ï†ÑÏ≤¥</span>
                <span class="site-selector-icon">‚ñº</span>
                <div class="site-dropdown" id="siteDropdown">
                    <div class="site-option" data-value="all" data-i18n="nav.site.all">Ï°∞ÏÑ†ÏÜå Ï†ÑÏ≤¥</div>
                    <div class="site-option" data-value="line1" data-i18n="nav.site.line1">1ÎùºÏù∏</div>
                    <div class="site-option" data-value="line2" data-i18n="nav.site.line2">2ÎùºÏù∏</div>
                    <div class="site-option" data-value="line3" data-i18n="nav.site.line3">3ÎùºÏù∏</div>
                </div>
            </div>
            <div class="live-indicator">
                <span class="live-dot"></span>
                <span class="live-text" data-i18n="nav.live">Live Now</span>
                <span class="live-count" id="liveCount">12,243</span>
                <span class="live-label" data-i18n="nav.live.label">welds today</span>
            </div>
        </div>
        <div class="nav-right">
            <div class="lang-selector">
                <button class="lang-option active" data-lang="en">EN</button>
                <button class="lang-option" data-lang="ko">ÌïúÍ∏Ä</button>
            </div>
            <div class="date-picker" id="datePickerDropdown">
                <span>üìÖ</span>
                <span class="date-picker-text" id="selectedDate" data-i18n="nav.date.30d">ÏµúÍ∑º 30Ïùº</span>
                <span class="date-picker-icon">‚ñº</span>
                <div class="date-dropdown" id="dateDropdown">
                    <div class="date-option" data-value="1d" data-i18n="nav.date.1d">ÏµúÍ∑º 1Ïùº</div>
                    <div class="date-option" data-value="3d" data-i18n="nav.date.3d">ÏµúÍ∑º 3Ïùº</div>
                    <div class="date-option" data-value="5d" data-i18n="nav.date.5d">ÏµúÍ∑º 5Ïùº</div>
                    <div class="date-option" data-value="10d" data-i18n="nav.date.10d">ÏµúÍ∑º 10Ïùº</div>
                    <div class="date-option" data-value="15d" data-i18n="nav.date.15d">ÏµúÍ∑º 15Ïùº</div>
                    <div class="date-option" data-value="30d" data-i18n="nav.date.30d">ÏµúÍ∑º 30Ïùº</div>
                </div>
            </div>
            <div class="user-profile" id="userProfileDropdown">
                <div class="user-avatar">
                    <img src="assets/icons/worker.png" alt="User" class="user-avatar-img">
                </div>
                <div class="user-dropdown" id="userDropdown">
                    <div class="user-dropdown-header">
                        <img src="assets/icons/worker.png" alt="User" class="user-dropdown-avatar">
                        <div class="user-dropdown-info">
                            <div class="user-dropdown-name">Can Berk Sansoy</div>
                            <div class="user-dropdown-email">admin@rbware.com</div>
                        </div>
                    </div>
                    <div class="user-dropdown-divider"></div>
                    <div class="user-dropdown-menu">
                        <div class="user-menu-item">
                            <span class="user-menu-icon">üë§</span>
                            <span data-i18n="user.profile">ÌîÑÎ°úÌïÑ</span>
                        </div>
                        <div class="user-menu-item">
                            <span class="user-menu-icon">‚öôÔ∏è</span>
                            <span data-i18n="user.settings">ÏÑ§Ï†ï</span>
                        </div>
                        <div class="user-menu-item">
                            <span class="user-menu-icon">üîî</span>
                            <span data-i18n="user.notifications">ÏïåÎ¶º</span>
                        </div>
                        <div class="user-menu-item">
                            <span class="user-menu-icon">‚ùì</span>
                            <span data-i18n="user.help">ÎèÑÏõÄÎßê</span>
                        </div>
                    </div>
                    <div class="user-dropdown-divider"></div>
                    <div class="user-menu-item logout">
                        <span class="user-menu-icon">üö™</span>
                        <span data-i18n="user.logout">Î°úÍ∑∏ÏïÑÏõÉ</span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Sidebar -->
    <aside class="sidebar">
        <ul class="sidebar-menu">
            <li class="menu-item">
                <a href="index.html" style="display: flex; align-items: center; gap: var(--spacing-sm); color: inherit; text-decoration: none;">
                    <span class="menu-icon">üìä</span>
                    <span data-i18n="menu.dashboard">Dashboard</span>
                </a>
            </li>
            <li class="menu-item active">
                <a href="live-operations.html" style="display: flex; align-items: center; gap: var(--spacing-sm); color: inherit; text-decoration: none;">
                    <span class="menu-icon">‚ö°</span>
                    <span data-i18n="menu.operations">Live Operations</span>
                </a>
            </li>
            <li class="menu-item">
                <span class="menu-icon">üõ°Ô∏è</span>
                <span data-i18n="menu.quality">Quality Guardian</span>
            </li>
            <li class="menu-item">
                <span class="menu-icon">üìã</span>
                <span data-i18n="menu.recipes">Recipes & Playbook</span>
            </li>
            <li class="menu-item">
                <span class="menu-icon">üí∞</span>
                <span data-i18n="menu.roi">ROI Simulator</span>
            </li>
            <li class="menu-item">
                <span class="menu-icon">ü§ñ</span>
                <span data-i18n="menu.fleet">Fleet View</span>
            </li>
            <li class="menu-item">
                <span class="menu-icon">üß†</span>
                <span data-i18n="menu.ai">Data & AI Engine</span>
            </li>
        </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Page Header with Filters -->
        <header class="ops-page-header">
            <div class="ops-header-left">
                <h1 class="ops-page-title" data-i18n="ops.title">Live Operations & Alarm Center</h1>
                <p class="ops-page-subtitle" data-i18n="ops.subtitle">Monitor live welding conditions and prevent issues before they become failures.</p>
            </div>
            <div class="ops-header-right">
                <div class="ops-filter">
                    <label>Cell / Line</label>
                    <select class="ops-select" id="cellSelect">
                        <option value="line3-a">Line 3 ‚Äì MIG Cell A</option>
                        <option value="line3-b">Line 3 ‚Äì MIG Cell B</option>
                        <option value="line2-a">Line 2 ‚Äì TIG Cell A</option>
                        <option value="line1-a">Line 1 ‚Äì Spot Weld</option>
                    </select>
                </div>
                <div class="ops-filter">
                    <label>Time Window</label>
                    <select class="ops-select" id="timeWindowSelect">
                        <option value="live">Live</option>
                        <option value="5min">Last 5 min</option>
                        <option value="30min">Last 30 min</option>
                    </select>
                </div>
            </div>
        </header>

        <!-- Top Row: Active Cell + Live Metrics -->
        <div class="ops-row">
            <!-- Left: Active Cell Summary -->
            <div class="ops-col-6">
                <div class="ops-card">
                    <div class="ops-card-header">
                        <h2 class="ops-card-title" data-i18n="ops.cell.title">Active Cell ‚Äì Line 3 ¬∑ MIG Cell A</h2>
                    </div>
                    <div class="ops-cell-status">
                        <div class="ops-status-item">
                            <span class="ops-status-icon"></span>
                            <span class="ops-status-label" data-i18n="ops.status.robot">Robot:</span>
                            <span class="ops-status-value status-running">
                                <span class="status-dot green"></span>
                                <span data-i18n="ops.status.running">Running</span>
                            </span>
                        </div>
                        <div class="ops-status-item">
                            <span class="ops-status-icon">‚ö°</span>
                            <span class="ops-status-label" data-i18n="ops.status.welder">Welder:</span>
                            <span class="ops-status-value status-arc-on">
                                <span class="status-dot orange"></span>
                                <span data-i18n="ops.status.arcon">Arc On</span>
                            </span>
                        </div>
                        <div class="ops-status-item">
                            <span class="ops-status-icon">üõ°Ô∏è</span>
                            <span class="ops-status-label" data-i18n="ops.status.safety">Safety:</span>
                            <span class="ops-status-value status-ok">
                                <span class="status-dot green"></span>
                                <span data-i18n="ops.status.ok">OK</span>
                            </span>
                        </div>
                    </div>

                    <div class="ops-job-info">
                        <div class="ops-job-header">
                            <h3 data-i18n="ops.job.current">Current Job</h3>
                        </div>
                        <div class="ops-job-detail">
                            <div class="ops-job-name">HYUNDAI_DOOR_INNER_STEP_12</div>
                            <div class="ops-job-meta">
                                <span>Pass: <strong>1 / 2</strong></span>
                                <span>Time: <strong>7.4s</strong> / 11.2s</span>
                            </div>
                        </div>
                    </div>

                    <div class="ops-instant-values">
                        <div class="ops-instant-item">
                            <span class="ops-instant-label">Current:</span>
                            <span class="ops-instant-value">210 A</span>
                        </div>
                        <div class="ops-instant-item">
                            <span class="ops-instant-label">Voltage:</span>
                            <span class="ops-instant-value">24.5 V</span>
                        </div>
                        <div class="ops-instant-item">
                            <span class="ops-instant-label">WFS:</span>
                            <span class="ops-instant-value">9.8 m/min</span>
                        </div>
                        <div class="ops-instant-item">
                            <span class="ops-instant-label">TAST:</span>
                            <span class="ops-instant-value">+35</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right: Live Metrics Tiles -->
            <div class="ops-col-6">
                <div class="ops-metrics-grid">
                    <!-- Current Tile -->
                    <div class="ops-metric-card metric-current">
                        <div class="metric-header">
                            <span class="metric-label" data-i18n="ops.metric.current">Current (A)</span>
                        </div>
                        <div class="metric-value" id="metricCurrent">210</div>
                        <div class="metric-sparkline" id="sparklineCurrent"></div>
                        <div class="metric-status">
                            <span class="metric-target"><span data-i18n="ops.metric.target">Target:</span> 200 ¬± 10 A</span>
                            <span class="metric-badge badge-success" data-i18n="ops.metric.range">Within range</span>
                        </div>
                    </div>

                    <!-- Voltage Tile -->
                    <div class="ops-metric-card metric-voltage">
                        <div class="metric-header">
                            <span class="metric-label" data-i18n="ops.metric.voltage">Voltage (V)</span>
                        </div>
                        <div class="metric-value" id="metricVoltage">24.5</div>
                        <div class="metric-sparkline" id="sparklineVoltage"></div>
                        <div class="metric-status">
                            <span class="metric-target"><span data-i18n="ops.metric.target">Target:</span> 24 ¬± 2 V</span>
                            <span class="metric-badge badge-success" data-i18n="ops.metric.range">Within range</span>
                        </div>
                    </div>

                    <!-- WFS Tile -->
                    <div class="ops-metric-card metric-wfs">
                        <div class="metric-header">
                            <span class="metric-label" data-i18n="ops.metric.wfs">Wire Feed Speed</span>
                        </div>
                        <div class="metric-value" id="metricWFS">9.8<span class="metric-unit">m/min</span></div>
                        <div class="metric-sparkline" id="sparklineWFS"></div>
                        <div class="metric-status">
                            <span class="metric-target"><span data-i18n="ops.metric.target">Target:</span> 10 ¬± 1 m/min</span>
                            <span class="metric-badge badge-success" data-i18n="ops.metric.range">Within range</span>
                        </div>
                    </div>

                    <!-- TAST Tile -->
                    <div class="ops-metric-card metric-tast">
                        <div class="metric-header">
                            <span class="metric-label" data-i18n="ops.metric.tast">TAST</span>
                        </div>
                        <div class="metric-value" id="metricTAST">+125</div>
                        <div class="metric-sparkline" id="sparklineTAST"></div>
                        <div class="metric-status">
                            <span class="metric-target">Range: ¬±100</span>
                            <span class="metric-badge badge-warning" data-i18n="ops.metric.outofrange">Out of range</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Middle Row: Live Signal Graphs + Alarm Timeline -->
        <div class="ops-row">
            <!-- Left: Live Signal Graphs -->
            <div class="ops-col-7">
                <div class="ops-card ops-graph-card">
                    <div class="ops-card-header">
                        <h2 class="ops-card-title" data-i18n="ops.chart.cv">Current & Voltage (Last 30 sec)</h2>
                    </div>
                    <div class="ops-chart-container" id="chartCurrentVoltage">
                        <!-- Chart will be rendered here -->
                    </div>
                </div>

                <div class="ops-card ops-graph-card" style="margin-top: 16px;">
                    <div class="ops-card-header">
                        <h2 class="ops-card-title" data-i18n="ops.chart.wfstast">Wire Feed Speed & TAST (Last 30 sec)</h2>
                    </div>
                    <div class="ops-chart-container" id="chartWFSTAST">
                        <!-- Chart will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- Right: Alarm Timeline -->
            <div class="ops-col-5">
                <div class="ops-card">
                    <div class="ops-card-header">
                        <h2 class="ops-card-title" data-i18n="ops.alarm.title">Alarms & Events ‚Äì Last 10 min</h2>
                        <div class="ops-alarm-filters">
                            <button class="alarm-filter-btn active" data-filter="all" data-i18n="ops.alarm.all">All</button>
                            <button class="alarm-filter-btn" data-filter="warning" data-i18n="ops.alarm.warning">Warning</button>
                            <button class="alarm-filter-btn" data-filter="critical" data-i18n="ops.alarm.critical">Critical</button>
                        </div>
                    </div>
                    <div class="ops-alarm-timeline">
                        <div class="alarm-item alarm-warning">
                            <div class="alarm-time">10:21:34</div>
                            <div class="alarm-content">
                                <div class="alarm-icon">‚ö°</div>
                                <div class="alarm-details">
                                    <div class="alarm-title" data-i18n="ops.event.voltage.spike">Voltage spike detected (31.8 V)</div>
                                    <div class="alarm-action" data-i18n="ops.event.voltage.action">Auto action: reduced travel speed by 20%</div>
                                </div>
                            </div>
                            <div class="alarm-badge badge-resolved" data-i18n="ops.alarm.resolved">Resolved</div>
                        </div>

                        <div class="alarm-item alarm-info">
                            <div class="alarm-time">10:20:15</div>
                            <div class="alarm-content">
                                <div class="alarm-icon">ü§ñ</div>
                                <div class="alarm-details">
                                    <div class="alarm-title" data-i18n="ops.event.cycle.complete">Program cycle completed</div>
                                    <div class="alarm-action" data-i18n="ops.event.cycle.success">Job HYUNDAI_DOOR_STEP_11 finished successfully</div>
                                </div>
                            </div>
                            <div class="alarm-badge badge-info" data-i18n="ops.alarm.info">Info</div>
                        </div>

                        <div class="alarm-item alarm-critical">
                            <div class="alarm-time">10:18:42</div>
                            <div class="alarm-content">
                                <div class="alarm-icon">üî•</div>
                                <div class="alarm-details">
                                    <div class="alarm-title">TAST drift beyond limit (+420)</div>
                                    <div class="alarm-action">Operator confirmation required</div>
                                </div>
                            </div>
                            <div class="alarm-badge badge-critical" data-i18n="ops.alarm.critical">Critical</div>
                        </div>

                        <div class="alarm-item alarm-info">
                            <div class="alarm-time">10:16:23</div>
                            <div class="alarm-content">
                                <div class="alarm-icon">‚úì</div>
                                <div class="alarm-details">
                                    <div class="alarm-title">Wire feed speed normalized</div>
                                    <div class="alarm-action">Returned to target range (10.0 m/min)</div>
                                </div>
                            </div>
                            <div class="alarm-badge badge-resolved" data-i18n="ops.alarm.resolved">Resolved</div>
                        </div>

                        <div class="alarm-item alarm-warning">
                            <div class="alarm-time">10:14:08</div>
                            <div class="alarm-content">
                                <div class="alarm-icon">‚ö°</div>
                                <div class="alarm-details">
                                    <div class="alarm-title">Current fluctuation detected</div>
                                    <div class="alarm-action">Auto action: stabilized at 205 A</div>
                                </div>
                            </div>
                            <div class="alarm-badge badge-resolved" data-i18n="ops.alarm.resolved">Resolved</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Row: Running Jobs + Alarm Detail -->
        <div class="ops-row">
            <!-- Left: Running Jobs Table -->
            <div class="ops-col-7">
                <div class="ops-card">
                    <div class="ops-card-header">
                        <h2 class="ops-card-title" data-i18n="ops.table.jobs">Active & Recent Weld Jobs (Last 10 min)</h2>
                    </div>
                    <div class="ops-table-container">
                        <table class="ops-table">
                            <thead>
                                <tr>
                                    <th data-i18n="ops.table.starttime">Start Time</th>
                                    <th data-i18n="ops.table.jobname">Job Name</th>
                                    <th data-i18n="ops.table.cell">Cell / Line</th>
                                    <th data-i18n="ops.table.duration">Duration (s)</th>
                                    <th data-i18n="ops.table.risk">Quality Risk</th>
                                    <th data-i18n="ops.table.status">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="table-row-active">
                                    <td>10:21:00</td>
                                    <td><strong>HYUNDAI_DOOR_INNER_STEP_12</strong></td>
                                    <td>Line 3 ¬∑ Cell A</td>
                                    <td>7.4</td>
                                    <td><span class="risk-badge risk-low" data-i18n="ops.table.risk.low">Low</span></td>
                                    <td><span class="status-badge status-running" data-i18n="ops.table.status.running">Running</span></td>
                                </tr>
                                <tr>
                                    <td>10:20:40</td>
                                    <td>SHIP_BLOCK_07_PASS_2</td>
                                    <td>Block 7 ¬∑ Cell B</td>
                                    <td>12.1</td>
                                    <td><span class="risk-badge risk-medium" data-i18n="ops.table.risk.medium">Medium</span></td>
                                    <td><span class="status-badge status-completed" data-i18n="ops.table.status.completed">Completed</span></td>
                                </tr>
                                <tr>
                                    <td>10:20:10</td>
                                    <td>SUPPLIER_C_TRIAL_03</td>
                                    <td>Cell B</td>
                                    <td>4.3</td>
                                    <td><span class="risk-badge risk-high" data-i18n="ops.table.risk.high">High</span></td>
                                    <td><span class="status-badge status-failed" data-i18n="ops.table.status.failed">Failed</span></td>
                                </tr>
                                <tr>
                                    <td>10:19:35</td>
                                    <td>HYUNDAI_DOOR_OUTER_STEP_08</td>
                                    <td>Line 3 ¬∑ Cell A</td>
                                    <td>9.8</td>
                                    <td><span class="risk-badge risk-low" data-i18n="ops.table.risk.low">Low</span></td>
                                    <td><span class="status-badge status-completed" data-i18n="ops.table.status.completed">Completed</span></td>
                                </tr>
                                <tr>
                                    <td>10:18:22</td>
                                    <td>BLOCK_05_SEAM_WELD</td>
                                    <td>Block 5 ¬∑ Cell C</td>
                                    <td>15.2</td>
                                    <td><span class="risk-badge risk-medium" data-i18n="ops.table.risk.medium">Medium</span></td>
                                    <td><span class="status-badge status-completed" data-i18n="ops.table.status.completed">Completed</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Right: Alarm/Auto Action Detail Panel -->
            <div class="ops-col-5">
                <div class="ops-card">
                    <div class="ops-card-header">
                        <h2 class="ops-card-title" data-i18n="ops.detail.title">Selected Event Detail</h2>
                    </div>
                    <div class="ops-detail-panel">
                        <div class="detail-section">
                            <h3 class="detail-title" data-i18n="ops.event.voltage.spike">Voltage spike detected (31.8 V)</h3>
                            <div class="detail-meta">
                                <div class="detail-meta-item">
                                    <span class="detail-label" data-i18n="ops.detail.time">Time:</span>
                                    <span class="detail-value">10:21:34</span>
                                </div>
                                <div class="detail-meta-item">
                                    <span class="detail-label" data-i18n="ops.detail.job">Related Job:</span>
                                    <span class="detail-value">HYUNDAI_DOOR_INNER_STEP_12</span>
                                </div>
                                <div class="detail-meta-item">
                                    <span class="detail-label" data-i18n="ops.detail.cell">Cell:</span>
                                    <span class="detail-value">Line 3 ‚Äì MIG Cell A</span>
                                </div>
                            </div>
                        </div>

                        <div class="detail-section">
                            <h4 class="detail-subtitle" data-i18n="ops.detail.snapshot">Signal Snapshot</h4>
                            <div class="detail-mini-chart" id="detailMiniChart">
                                <!-- Mini chart will be rendered here -->
                            </div>
                        </div>

                        <div class="detail-section">
                            <h4 class="detail-subtitle" data-i18n="ops.detail.system.action">System Action</h4>
                            <div class="detail-action-list">
                                <div class="detail-action-item">
                                    <span class="action-icon">‚úì</span>
                                    <span data-i18n="ops.detail.action.speed">Reduced travel speed from 60 cm/min to 45 cm/min</span>
                                </div>
                                <div class="detail-action-item">
                                    <span class="action-icon">üîç</span>
                                    <span data-i18n="ops.detail.action.flag">Flagged weld for post-weld quality check</span>
                                </div>
                            </div>
                        </div>

                        <div class="detail-section">
                            <h4 class="detail-subtitle" data-i18n="ops.detail.operator.action">Operator Action</h4>
                            <div class="detail-operator-status">
                                <span class="status-badge status-pending" data-i18n="ops.alarm.pending">Pending</span>
                                <button class="btn-confirm" data-i18n="ops.detail.confirm">Confirm as Normal</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="js/i18n.js"></script>
    <script src="js/main.js"></script>
    <script src="js/live-operations.js"></script>
</body>
</html>
