<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Operations & Alarm Center - Weld Insight</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/live-operations.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
</head>
<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="nav-left">
            <a href="main.html" class="logo" style="display: flex; align-items: center; gap: var(--spacing-sm); color: inherit; text-decoration: none;">
                <img src="assets/icons/rbw_logo.png" alt="RB-WARE" class="logo-image">
                <span>Weld Insight</span>
            </a>
        </div>
        <div class="nav-center">
            <div class="site-selector" id="siteSelectorDropdown">
                <span class="site-selector-text" id="selectedSite">Ï°∞ÏÑ†ÏÜå Ï†ÑÏ≤¥</span>
                <span class="site-selector-icon">‚ñº</span>
                <div class="site-dropdown" id="siteDropdown">
                    <div class="site-option" data-value="all">Ï°∞ÏÑ†ÏÜå Ï†ÑÏ≤¥</div>
                    <div class="site-option" data-value="line1">1ÎùºÏù∏</div>
                    <div class="site-option" data-value="line2">2ÎùºÏù∏</div>
                    <div class="site-option" data-value="line3">3ÎùºÏù∏</div>
                </div>
            </div>
            <div class="live-indicator">
                <span class="live-dot"></span>
                <span class="live-text">Live Now</span>
                <span class="live-count" id="liveCount">12,243</span>
                <span class="live-label">welds today</span>
            </div>
        </div>
        <div class="nav-right">
            <div class="lang-selector">
                <button class="lang-option active" data-lang="en">EN</button>
                <button class="lang-option" data-lang="ko">ÌïúÍ∏Ä</button>
            </div>
            <div class="date-picker" id="datePickerDropdown">
                <span>üìÖ</span>
                <span class="date-picker-text" id="selectedDate">ÏµúÍ∑º 30Ïùº</span>
                <span class="date-picker-icon">‚ñº</span>
                <div class="date-dropdown" id="dateDropdown">
                    <div class="date-option" data-value="1d">ÏµúÍ∑º 1Ïùº</div>
                    <div class="date-option" data-value="3d">ÏµúÍ∑º 3Ïùº</div>
                    <div class="date-option" data-value="5d">ÏµúÍ∑º 5Ïùº</div>
                    <div class="date-option" data-value="10d">ÏµúÍ∑º 10Ïùº</div>
                    <div class="date-option" data-value="15d">ÏµúÍ∑º 15Ïùº</div>
                    <div class="date-option" data-value="30d">ÏµúÍ∑º 30Ïùº</div>
                </div>
            </div>
            <div class="user-profile" id="userProfileDropdown">
                <div class="user-avatar">
                    <img src="assets/icons/worker.png" alt="User" class="user-avatar-img">
                </div>
                <div class="user-dropdown" id="userDropdown">
                    <div class="user-dropdown-header">
                        <img src="assets/icons/worker.png" alt="User" class="user-dropdown-avatar">
                        <div class="user-dropdown-info">
                            <div class="user-dropdown-name">Can Berk Sansoy</div>
                            <div class="user-dropdown-email">admin@rbware.com</div>
                        </div>
                    </div>
                    <div class="user-dropdown-divider"></div>
                    <div class="user-dropdown-menu">
                        <div class="user-menu-item">
                            <span class="user-menu-icon">üë§</span>
                            <span>ÌîÑÎ°úÌïÑ</span>
                        </div>
                        <div class="user-menu-item">
                            <span class="user-menu-icon">‚öôÔ∏è</span>
                            <span>ÏÑ§Ï†ï</span>
                        </div>
                        <div class="user-menu-item">
                            <span class="user-menu-icon">üîî</span>
                            <span>ÏïåÎ¶º</span>
                        </div>
                        <div class="user-menu-item">
                            <span class="user-menu-icon">‚ùì</span>
                            <span>ÎèÑÏõÄÎßê</span>
                        </div>
                    </div>
                    <div class="user-dropdown-divider"></div>
                    <div class="user-menu-item logout">
                        <span class="user-menu-icon">üö™</span>
                        <span>Î°úÍ∑∏ÏïÑÏõÉ</span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Sidebar -->
    <aside class="sidebar">
        <ul class="sidebar-menu">
            <li class="menu-item">
                <a href="dashboard.html" style="display: flex; align-items: center; gap: var(--spacing-sm); color: inherit; text-decoration: none;">
                    <span class="menu-icon">üìä</span>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="menu-item active">
                <a href="live-operations.html" style="display: flex; align-items: center; gap: var(--spacing-sm); color: inherit; text-decoration: none;">
                    <span class="menu-icon">‚ö°</span>
                    <span>Live Operations</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="quality-guardian.html" style="display: flex; align-items: center; gap: var(--spacing-sm); color: inherit; text-decoration: none;">
                    <span class="menu-icon">üõ°Ô∏è</span>
                    <span>Quality Guardian</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="recipes-playbook.html" style="display: flex; align-items: center; gap: var(--spacing-sm); color: inherit; text-decoration: none;">
                    <span class="menu-icon">üìã</span>
                    <span>Recipes & Playbook</span>
                </a>
            </li>
            <li class="menu-item">
                <span class="menu-icon">üí∞</span>
                <span>ROI Simulator</span>
            </li>
            <li class="menu-item">
                <span class="menu-icon">ü§ñ</span>
                <span>Fleet View</span>
            </li>
            <li class="menu-item">
                <span class="menu-icon">üß†</span>
                <span>Data & AI Engine</span>
            </li>
        </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Page Header -->
        <header class="page-header">
            <div class="page-header-left">
                <h1 class="page-title">Live Operations & Alarm Center</h1>
                <p class="page-subtitle">Monitor live welding conditions and prevent issues before they become failures.</p>
            </div>
            <div class="page-header-right">
                <div class="header-control">
                    <label>Cell / Line</label>
                    <select class="control-select" id="cellSelect">
                        <option value="line3-mig-a" selected>Line 3 ‚Äì MIG Cell A</option>
                        <option value="line3-mig-b">Line 3 ‚Äì MIG Cell B</option>
                        <option value="line2-tig-a">Line 2 ‚Äì TIG Cell A</option>
                        <option value="line1-spot">Line 1 ‚Äì Spot Welding</option>
                    </select>
                </div>
                <div class="header-control">
                    <label>Time Window</label>
                    <select class="control-select" id="timeSelect">
                        <option value="live" selected>Live</option>
                        <option value="5min">Last 5 min</option>
                        <option value="30min">Last 30 min</option>
                    </select>
                </div>
            </div>
        </header>

        <!-- Top Row: Active Cell Summary + Live Metrics -->
        <section class="grid-12 mb-xl">
            <!-- Active Cell Summary -->
            <div class="col-6">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Active Cell ‚Äì Line 3 ¬∑ MIG Cell A</h2>
                    </div>
                    <div class="cell-status-grid">
                        <div class="status-item">
                            <span class="status-icon">ü§ñ</span>
                            <div class="status-content">
                                <span class="status-label">Robot</span>
                                <span class="status-value">
                                    Running
                                    <span class="status-dot running"></span>
                                </span>
                            </div>
                        </div>
                        <div class="status-item">
                            <span class="status-icon">üî•</span>
                            <div class="status-content">
                                <span class="status-label">Welder</span>
                                <span class="status-value">
                                    Arc On
                                    <span class="status-dot arc-on"></span>
                                </span>
                            </div>
                        </div>
                        <div class="status-item">
                            <span class="status-icon">üõ°Ô∏è</span>
                            <div class="status-content">
                                <span class="status-label">Safety</span>
                                <span class="status-value">
                                    OK
                                    <span class="status-dot ok"></span>
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="job-info">
                        <div class="job-info-header">Current Job</div>
                        <div class="job-name">HYUNDAI_DOOR_INNER_STEP_12</div>
                        <div class="job-details">
                            <div class="job-detail">
                                <span class="detail-label">Pass:</span>
                                <span class="detail-value">1 / 2</span>
                            </div>
                            <div class="job-detail">
                                <span class="detail-label">Progress:</span>
                                <span class="detail-value">07.4 s / 11.2 s</span>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 66%"></div>
                        </div>
                    </div>

                    <div class="instant-values">
                        <div class="instant-value-item">
                            <span class="instant-icon">‚ö°</span>
                            <div class="instant-content">
                                <span class="instant-label">Current</span>
                                <span class="instant-number">210 A</span>
                            </div>
                        </div>
                        <div class="instant-value-item">
                            <span class="instant-icon">üîã</span>
                            <div class="instant-content">
                                <span class="instant-label">Voltage</span>
                                <span class="instant-number">24.5 V</span>
                            </div>
                        </div>
                        <div class="instant-value-item">
                            <span class="instant-icon">üìè</span>
                            <div class="instant-content">
                                <span class="instant-label">WFS</span>
                                <span class="instant-number">9.8 m/min</span>
                            </div>
                        </div>
                        <div class="instant-value-item">
                            <span class="instant-icon">üìê</span>
                            <div class="instant-content">
                                <span class="instant-label">TAST</span>
                                <span class="instant-number">+35 (-0.13mm)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Live Metrics Tiles -->
            <div class="col-6">
                <div class="metrics-grid">
                    <!-- Current Tile -->
                    <div class="metric-tile">
                        <div class="metric-header">
                            <span class="metric-label">Current (A)</span>
                        </div>
                        <div class="metric-value current-color">210</div>
                        <div class="metric-sparkline" id="currentSparkline"></div>
                        <div class="metric-range">
                            <span class="range-label">Target: 200 ¬± 10 A</span>
                            <span class="range-badge in-range">Within range</span>
                        </div>
                        <div class="range-indicator">
                            <div class="range-bar">
                                <div class="range-target"></div>
                                <div class="range-dot" style="left: 50%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Voltage Tile -->
                    <div class="metric-tile">
                        <div class="metric-header">
                            <span class="metric-label">Voltage (V)</span>
                        </div>
                        <div class="metric-value voltage-color">24.5</div>
                        <div class="metric-sparkline" id="voltageSparkline"></div>
                        <div class="metric-range">
                            <span class="range-label">Target: 24 ¬± 2 V</span>
                            <span class="range-badge in-range">Within range</span>
                        </div>
                        <div class="range-indicator">
                            <div class="range-bar">
                                <div class="range-target"></div>
                                <div class="range-dot" style="left: 25%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- WFS Tile -->
                    <div class="metric-tile">
                        <div class="metric-header">
                            <span class="metric-label">Wire Feed Speed (m/min)</span>
                        </div>
                        <div class="metric-value wfs-color">9.8</div>
                        <div class="metric-sparkline" id="wfsSparkline"></div>
                        <div class="metric-range">
                            <span class="range-label">Target: 10 ¬± 1 m/min</span>
                            <span class="range-badge in-range">Within range</span>
                        </div>
                        <div class="range-indicator">
                            <div class="range-bar">
                                <div class="range-target"></div>
                                <div class="range-dot" style="left: 40%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- TAST Tile -->
                    <div class="metric-tile">
                        <div class="metric-header">
                            <span class="metric-label">TAST</span>
                        </div>
                        <div class="metric-value tast-color">+35</div>
                        <div class="metric-sparkline" id="tastSparkline"></div>
                        <div class="metric-range">
                            <span class="range-label">-0.13 mm offset</span>
                            <span class="range-badge in-range">Normal</span>
                        </div>
                        <div class="range-indicator">
                            <div class="range-bar">
                                <div class="range-target"></div>
                                <div class="range-dot" style="left: 55%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Middle Row: Live Signal Graphs + Alarm Timeline -->
        <section class="grid-12 mb-xl">
            <!-- Live Signal Graphs -->
            <div class="col-8">
                <div class="card chart-card">
                    <div class="card-header">
                        <h2 class="card-title">Current & Voltage (Last 30 sec)</h2>
                    </div>
                    <div class="chart-container">
                        <canvas id="currentVoltageChart"></canvas>
                    </div>
                </div>

                <div class="card chart-card mt-lg">
                    <div class="card-header">
                        <h2 class="card-title">Wire Feed Speed & TAST (Last 30 sec)</h2>
                    </div>
                    <div class="chart-container">
                        <canvas id="wfsTastChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Alarm Timeline -->
            <div class="col-4">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Alarm Timeline</h2>
                        <span class="alarm-count">3 Active</span>
                    </div>
                    <div class="alarm-timeline">
                        <div class="alarm-item critical">
                            <div class="alarm-time">13:42:18</div>
                            <div class="alarm-content">
                                <div class="alarm-title">Current Spike Detected</div>
                                <div class="alarm-description">Current exceeded 220A (limit: 210A)</div>
                                <div class="alarm-badge badge-critical">Critical</div>
                            </div>
                        </div>

                        <div class="alarm-item warning">
                            <div class="alarm-time">13:41:55</div>
                            <div class="alarm-content">
                                <div class="alarm-title">TAST Rapid Change</div>
                                <div class="alarm-description">TAST changed ¬±180 in 2 seconds</div>
                                <div class="alarm-badge badge-warning">Warning</div>
                            </div>
                        </div>

                        <div class="alarm-item info">
                            <div class="alarm-time">13:41:20</div>
                            <div class="alarm-content">
                                <div class="alarm-title">Wire Feed Adjusted</div>
                                <div class="alarm-description">Auto-correction: 9.2 ‚Üí 9.8 m/min</div>
                                <div class="alarm-badge badge-info">Info</div>
                            </div>
                        </div>

                        <div class="alarm-item resolved">
                            <div class="alarm-time">13:40:45</div>
                            <div class="alarm-content">
                                <div class="alarm-title">Voltage Stabilized</div>
                                <div class="alarm-description">Voltage returned to normal range</div>
                                <div class="alarm-badge badge-resolved">Resolved</div>
                            </div>
                        </div>

                        <div class="alarm-item resolved">
                            <div class="alarm-time">13:39:12</div>
                            <div class="alarm-content">
                                <div class="alarm-title">Gas Flow Normal</div>
                                <div class="alarm-description">Shielding gas pressure restored</div>
                                <div class="alarm-badge badge-resolved">Resolved</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Bottom Row: Running Jobs + Alarm Detail -->
        <section class="grid-12">
            <!-- Running Jobs Table -->
            <div class="col-7">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Running Jobs</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Robot / Cell</th>
                                <th>Job Name</th>
                                <th>Progress</th>
                                <th>Time Remaining</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-row-active">
                                <td class="table-plant-name">Line 3 ‚Äì MIG Cell A</td>
                                <td>HYUNDAI_DOOR_INNER_STEP_12</td>
                                <td>
                                    <div class="table-progress">
                                        <div class="table-progress-bar">
                                            <div class="table-progress-fill" style="width: 66%"></div>
                                        </div>
                                        <span class="table-progress-text">66%</span>
                                    </div>
                                </td>
                                <td>3.8 s</td>
                                <td><span class="badge success">Welding</span></td>
                            </tr>
                            <tr>
                                <td class="table-plant-name">Line 3 ‚Äì MIG Cell B</td>
                                <td>KIA_FRAME_ASSY_05</td>
                                <td>
                                    <div class="table-progress">
                                        <div class="table-progress-bar">
                                            <div class="table-progress-fill" style="width: 34%"></div>
                                        </div>
                                        <span class="table-progress-text">34%</span>
                                    </div>
                                </td>
                                <td>8.2 s</td>
                                <td><span class="badge success">Welding</span></td>
                            </tr>
                            <tr>
                                <td class="table-plant-name">Line 2 ‚Äì TIG Cell A</td>
                                <td>PRECISION_TUBE_WELD_A8</td>
                                <td>
                                    <div class="table-progress">
                                        <div class="table-progress-bar">
                                            <div class="table-progress-fill" style="width: 89%"></div>
                                        </div>
                                        <span class="table-progress-text">89%</span>
                                    </div>
                                </td>
                                <td>1.3 s</td>
                                <td><span class="badge success">Welding</span></td>
                            </tr>
                            <tr>
                                <td class="table-plant-name">Line 1 ‚Äì Spot Welding</td>
                                <td>CHASSIS_SPOT_PATTERN_C</td>
                                <td>
                                    <div class="table-progress">
                                        <div class="table-progress-bar">
                                            <div class="table-progress-fill" style="width: 12%"></div>
                                        </div>
                                        <span class="table-progress-text">12%</span>
                                    </div>
                                </td>
                                <td>14.5 s</td>
                                <td><span class="badge warning">Starting</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Alarm / Auto Action Detail -->
            <div class="col-5">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Alarm Detail & Auto Actions</h2>
                    </div>
                    <div class="alarm-detail-panel">
                        <div class="detail-section">
                            <div class="detail-header">
                                <span class="detail-icon critical">‚ö†Ô∏è</span>
                                <span class="detail-title">Current Spike Detected</span>
                            </div>
                            <div class="detail-info">
                                <div class="detail-row">
                                    <span class="detail-label">Time:</span>
                                    <span class="detail-value">13:42:18</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Severity:</span>
                                    <span class="detail-value critical-text">Critical</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Parameter:</span>
                                    <span class="detail-value">Current: 225A (limit: 210A)</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Duration:</span>
                                    <span class="detail-value">0.8 seconds</span>
                                </div>
                            </div>
                        </div>

                        <div class="detail-section">
                            <div class="detail-header">
                                <span class="detail-icon info">ü§ñ</span>
                                <span class="detail-title">Auto Actions Taken</span>
                            </div>
                            <div class="action-log">
                                <div class="action-log-item">
                                    <span class="action-time">13:42:19</span>
                                    <span class="action-text">Reduced current setpoint to 205A</span>
                                </div>
                                <div class="action-log-item">
                                    <span class="action-time">13:42:20</span>
                                    <span class="action-text">Adjusted wire feed to 9.5 m/min</span>
                                </div>
                                <div class="action-log-item">
                                    <span class="action-time">13:42:21</span>
                                    <span class="action-text">Monitoring for 10 seconds</span>
                                </div>
                            </div>
                        </div>

                        <div class="detail-actions">
                            <button class="btn-action btn-acknowledge">Acknowledge Alarm</button>
                            <button class="btn-action btn-override">Override Auto Action</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/live-operations.js"></script>
</body>
</html>
